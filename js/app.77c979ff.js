(function(){"use strict";var t={3327:function(t,e,s){var r=s(144),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-app",{class:"theme-"+t.themeColor},[s("v-main",[s("router-view")],1)],1)},n=[],i={name:"App",data(){return{themeColor:"main"}},methods:{onSwitchThemeColor(t){this.themeColor=t?"orange":"main"}},created(){this.$eventBus.$on("alert:theme",this.onSwitchThemeColor)},beforeDestroy(){this.$eventBus.$off("alert:theme")}},o=i,c=s(1001),l=s(3453),h=s.n(l),d=s(7524),u=s(1009),m=(0,c.Z)(o,a,n,!1,null,null,null),p=m.exports;h()(m,{VApp:d.Z,VMain:u.Z});var f=s(8345),v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-container",{staticClass:"d-flex vh-100 py-0"},[s("v-row",{attrs:{dense:!0,"no-gutters":""}},[s("v-col",{staticClass:"py-0",attrs:{cols:"4",md:"3"}},[s("friends-list",{staticClass:"h-100",on:{"user-select":t.userSelectHandler}})],1),s("v-col",{staticClass:"py-0",attrs:{cols:"8",md:"9"}},[s("cherri-chatroom-warp",{attrs:{userId:t.userId}})],1)],1)],1)},g=[],C=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"box-shadow--right"},[s("div",{staticClass:"py-3"},[t._v(t._s(t.$t("friends_list"))+"("+t._s(t.friendsList.length)+")")]),s("div",{staticClass:"c-list c-list--devide"},t._l(t.friendsList,(function(e){return s("div",{key:e.userId,staticClass:"c-list-item d-flex align-center",class:{"c-list-item--active":t.seletedUserId===e.userId},on:{click:function(s){return t.onClickHandler(e.userId)}}},[s("img",{staticClass:"rounded-circle",attrs:{src:e.avatar,alt:"user picture"}}),s("div",{staticClass:"pl-4"},[s("p",{staticClass:"mb-0"},[t._v(t._s(e.name))]),s("p",{staticClass:"mb-0"},[t._v(t._s(e.description))])])])})),0)])},x=[],_={name:"FriendsList",data:()=>({seletedUserId:"",friendsList:[]}),methods:{onClickHandler(t){this.seletedUserId=t,this.$emit("user-select",t)},getFriendList(){this.$http.apiGetUserList().then((t=>this.friendsList=[...t])).catch((t=>console.error(t)))}},created(){this.getFriendList()}},w=_,b=(0,c.Z)(w,C,x,!1,null,null,null),y=b.exports,I=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"c-layout d-flex flex-column vh-100"},[s("HeaderBar"),s(t.componentsName,{tag:"component",staticClass:"flex-grow-1",attrs:{userId:t.userId}})],1)},O=[],S=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("nav",{staticClass:"nav"},[s("div",{staticClass:"nav-content d-flex flex-grow-1 align-center"},[s("h1",{staticClass:"text-h5 white--text"},[t._v("Cherri Chat")]),s("div",{staticClass:"d-flex align-center ml-auto"},[s("div",[s("v-btn",{staticClass:"rounded-pill font-bold mr-2",class:{"btn--active":"zh-tw"===t.$i18n.locale},attrs:{outlined:"",small:"",color:"white"},on:{click:function(e){return t.onSwitchLanguage("zh-tw")}}},[t._v(" 中文 ")]),s("v-btn",{staticClass:"rounded-pill font-bold",class:{"btn--active":"en-us"===t.$i18n.locale},attrs:{outlined:"",small:"",color:"white"},on:{click:function(e){return t.onSwitchLanguage("en-us")}}},[t._v(" English ")])],1),s("span",{staticClass:"white--text ml-2 mr-1"},[t._v(t._s(t.$t("theme_switch"))+": ")]),s("label",{staticClass:"switch"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.themeColor,expression:"themeColor"}],attrs:{type:"checkbox",value:"orange"},domProps:{checked:Array.isArray(t.themeColor)?t._i(t.themeColor,"orange")>-1:t.themeColor},on:{change:function(e){var s=t.themeColor,r=e.target,a=!!r.checked;if(Array.isArray(s)){var n="orange",i=t._i(s,n);r.checked?i<0&&(t.themeColor=s.concat([n])):i>-1&&(t.themeColor=s.slice(0,i).concat(s.slice(i+1)))}else t.themeColor=a}}}),s("span",{staticClass:"slider round"})])])]),t._m(0)])},Z=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"nav-append d-flex align-center ml-3"},[s("div",{staticClass:"border-left--white d-flex align-center px-5"},[s("img",{staticClass:"rounded-circle",attrs:{src:"https://picsum.photos/id/237/50/50",alt:"user picture"}}),s("p",{staticClass:"text-h6 white--text mb-0 pl-2"},[t._v("潔西卡")])])])}],$={data:()=>({themeColor:!1}),watch:{themeColor(){this.onSwitchThemeColor()}},methods:{onSwitchLanguage(t){this.$i18n.locale=t,sessionStorage.setItem("cherri-chat-language",t)},onSwitchThemeColor(){this.$eventBus.$emit("alert:theme",this.themeColor)}}},k=$,N=s(680),L=(0,c.Z)(k,S,Z,!1,null,null,null),T=L.exports;h()(L,{VBtn:N.Z});var j=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"d-flex flex-column"},[s("div",{staticClass:"d-flex align-center justify-space-between box-shadow--bottom py-2 px-5"},[s("div",{staticClass:"d-flex align-center"},[s("img",{staticClass:"rounded-circle",attrs:{src:t.chatroomInfo.avatar,alt:"user picture"}}),s("p",{staticClass:"text-h6 pl-3 mb-0"},[t._v(t._s(t.chatroomInfo.name))])]),s("div",{staticClass:"d-flex"},[s("v-btn",{staticClass:"mx-1",attrs:{icon:!0},on:{click:function(e){t.searchObj.isOpen=!t.searchObj.isOpen}}},[s("i",{staticClass:"c-icon c-icon--search"})]),s("v-menu",{attrs:{"offset-y":"","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,a=e.attrs;return[s("v-btn",t._g(t._b({attrs:{icon:!0}},"v-btn",a,!1),r),[s("i",{staticClass:"c-icon c-icon--note"})])]}}])},[s("user-note")],1)],1)]),s("div",{staticClass:"position-relative"},[s("v-text-field",{directives:[{name:"show",rawName:"v-show",value:t.searchObj.isOpen,expression:"searchObj.isOpen"}],staticClass:"w-100 position-absolute px-2 background-transparent",attrs:{color:"success"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearchHandler.apply(null,arguments)}},model:{value:t.searchObj.text,callback:function(e){t.$set(t.searchObj,"text",e)},expression:"searchObj.text"}},[s("template",{slot:"append"},[s("div",{staticClass:"d-flex align-center"},[s("p",{staticClass:"mb-0 text-gray"},[t._v(t._s(t.$tc("search_message_outcome",t.searchQuantity)))]),s("v-btn",{attrs:{icon:!0},on:{click:function(e){t.searchObj.text=""}}},[s("i",{staticClass:"c-icon c-icon--close-sm"})])],1)])],2)],1),s("div",{staticClass:"d-flex flex-column flex-grow-1"},[s("div",{staticClass:"d-flex flex-column-reverse align-end flex-grow-1 border-bottom--main vh-50 overflow-auto -scroll px-3 py-3"},t._l(t.reverseList,(function(e){return s("p",{key:e.id,staticClass:"chat-item chat-item--main rounded-pill",class:{"highlight-allow":t.allowUseHighlight()},domProps:{innerHTML:t._s(t.allowUseHighlight(e.highlight)?e.highlight:e.content)}})})),0),s("div",{staticClass:"d-flex px-2 py-3 h-20"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.chatText,expression:"chatText"}],staticClass:"form-control",attrs:{name:"chat text",placeholder:t.$t("placehoder_common")},domProps:{value:t.chatText},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addChatRecords.apply(null,arguments)},input:function(e){e.target.composing||(t.chatText=e.target.value)}}}),t._v(" "),s("v-btn",{attrs:{icon:!0},on:{click:t.addChatRecords}},[s("i",{staticClass:"c-icon c-icon--sent"})])],1)])])},U=[],R=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-card",{staticClass:"mx-auto",attrs:{"max-width":"350",tile:""}},[s("v-list-item",[s("v-list-item-content",[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.noteText,expression:"noteText"}],staticClass:"form-control border border--main pa-3",attrs:{name:"user note",cols:"30",rows:"5",placeholder:t.$t("placehoder_common")},domProps:{value:t.noteText},on:{input:function(e){e.target.composing||(t.noteText=e.target.value)}}}),s("v-btn",{staticClass:"btn--main mt-1 rounded-sm",on:{click:t.addUserNote}},[t._v(t._s(t.$t("add_common")))])],1)],1),s("div",{staticClass:"px-4 py-2"},[s("v-divider",{staticClass:"border--second"})],1),t._l(t.userNoteList,(function(e){return s("v-list-item",{key:e.id,staticClass:"pb-3"},[s("v-list-item-content",[s("div",{staticClass:"border border--second pa-2 position-relative"},[s("v-list-item-title",{staticClass:"text-main"},[t._v(t._s(t.getFormatTime(e.date)))]),s("p",{staticClass:"mb-0 mt-2"},[t._v(t._s(e.content))]),s("v-btn",{staticClass:"position-absolute to-right-top",attrs:{icon:!0},on:{click:function(s){return t.deleteUserNote(e.id)}}},[s("i",{staticClass:"c-icon c-icon--close-xs"})])],1)])],1)}))],2)},V=[],E={data(){return{userNoteList:[],noteText:""}},methods:{getUserNote(){this.$http.apiGetUserNote().then((t=>{this.userNoteList=[...t]})).catch((t=>{console.error(t)}))},getFormatTime(t){let e=new Date(Number(t)).toLocaleString("zh-tw",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});return e},addUserNote(){if(!this.noteText.trim())return;let t={userId:"Jessica",content:this.noteText.trim(),date:(new Date).getTime()};this.$http.apiAddUserNote(t),this.getUserNote(),this.noteText=""},deleteUserNote(t){this.$http.apiDeleteUserNote(t),this.getUserNote()}},created(){this.getUserNote()}},D=E,B=s(3237),G=s(1418),H=s(7620),A=s(4799),F=(0,c.Z)(D,R,V,!1,null,null,null),J=F.exports;h()(F,{VBtn:N.Z,VCard:B.Z,VDivider:G.Z,VListItem:H.Z,VListItemContent:A.km,VListItemTitle:A.V9});var P={name:"CherriChatroom",components:{UserNote:J},props:{userId:{type:String}},data:()=>({searchObj:{text:"",isOpen:!1},chatroomInfo:{userId:"",name:"",avatar:""},chatText:"",chatList:[]}),watch:{userId(){this.getChatRoomData()},"searchObj.text"(t){""==t&&this.getChatRecord()}},computed:{reverseList(){return[...this.chatList].reverse()},searchQuantity(){let t=this.searchObj.text.trim();if(!t)return 0;let e=this.chatList.map((t=>t.highlight)).join(""),s=new RegExp(`(${t})`,"g");return e.match(s,e)?e.match(s,e).length:0}},methods:{getFriendInfoById(){this.$http.apiGetUserById(this.userId).then((t=>{this.chatroomInfo={...this.chatroomInfo,...t[0]}})).catch((t=>{console.error(t)}))},getChatRecord(){this.$http.apiGetChatRecord(this.userId).then((t=>{this.chatList=[...t]})).catch((t=>{console.error(t)}))},getChatRoomData(){this.getFriendInfoById(),this.getChatRecord()},addChatRecords(){if(!this.chatText.trim())return;let t={chatroomId:this.userId,content:this.chatText.trim(),date:(new Date).getTime()};this.$http.apiAddChatRecord(t),this.getChatRoomData(),this.chatText=""},onSearchHandler(){this.searchObj.text.trim()&&(this.chatList=this.chatList.map((t=>{if(t.content.match(this.searchObj.text.trim())){const e=this.searchObj.text.trim();let s=new RegExp(`(${e})`,"g");t.highlight=t.content.replace(s,'<span class="highlight">$1</span>')}return t})))},allowUseHighlight(t){return this.searchObj.isOpen&&this.searchObj.text.trim()&&t}},created(){this.getChatRoomData()}},M=P,z=s(4985),Q=s(1347),W=(0,c.Z)(M,j,U,!1,null,null,null),q=W.exports;h()(W,{VBtn:N.Z,VMenu:z.Z,VTextField:Q.Z});var K=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"w-100"},[r("div",{staticClass:"text-center default-align"},[r("img",{attrs:{width:"180",height:"150",src:s(5786),alt:"default image"}}),r("p",{staticClass:"text-h5 text-main mt-2"},[t._v(t._s(t.$t("welcome_phrase")))])])])},X=[],Y={name:"DefaultView"},tt=Y,et=(0,c.Z)(tt,K,X,!1,null,null,null),st=et.exports,rt={name:"CherriChatroomWarp",components:{HeaderBar:T,CherriChatroom:q,DefaultView:st},props:{userId:{type:String}},computed:{componentsName(){return this.userId?"CherriChatroom":"DefaultView"}}},at=rt,nt=(0,c.Z)(at,I,O,!1,null,null,null),it=nt.exports,ot={name:"CherriChat",components:{FriendsList:y,CherriChatroomWarp:it},data:()=>({userId:""}),methods:{userSelectHandler(t){this.userId=t}}},ct=ot,lt=s(2102),ht=s(247),dt=s(2877),ut=(0,c.Z)(ct,v,g,!1,null,null,null),mt=ut.exports;h()(ut,{VCol:lt.Z,VContainer:ht.Z,VRow:dt.Z}),r.Z.use(f.Z);const pt=[{path:"/",name:"home",component:mt}],ft=new f.Z({routes:pt});var vt=ft,gt=s(629);r.Z.use(gt.ZP);var Ct=new gt.ZP.Store({state:{},getters:{},mutations:{},actions:{},modules:{}}),xt=s(7152);const _t={friends_list:"好友列表",welcome_phrase:"開始使用 Cherri Chat",placehoder_common:"輸入訊息...",search_message_outcome:"{n} 則相符訊息",add_common:"新增",theme_switch:"切換主題"};var wt=_t;const bt={friends_list:"Friends List",welcome_phrase:"Start Using Cherri Chat",placehoder_common:"Enter Messages...",search_message_outcome:"{n} matching message | {n} matching messages",add_common:"Add",theme_switch:"Theme"};var yt=bt;r.Z.use(xt.Z);let It="en-us"===sessionStorage.getItem("cherri-chat-language")?"en-us":"zh-tw";const Ot={"zh-tw":wt,"en-us":yt},St=new xt.Z({locale:It,messages:Ot});var Zt=St,$t=s(9132);r.Z.use($t.Z);var kt=new $t.Z({}),Nt=(s(1703),s(9669)),Lt=s.n(Nt),Tt=s(5934);let jt=null,Ut=null,Rt=null,Vt=null,Et=null,Dt=null,Bt=null;const Gt="mock/",Ht=Lt().create({baseURL:Gt});jt=async()=>{try{const t=await Ht.get("apiGetUserList.json");return t.data}catch(t){return t}},Ut=async t=>{try{const e=await Ht.get("apiGetUserList.json");return e.data.filter((e=>e.userId===t))}catch(e){return e}},Rt=async t=>{try{if(!t)throw new Error("chatroomId can't be null");const e=await Ht.get("apiGetChatRecord.json"),s=e.data.filter((e=>e.chatroomId===t));let r=localStorage.getItem("cherri-append-chatrecord");return r=r?JSON.parse(r).filter((e=>e.chatroomId===t)):[],[...s,...r]}catch(e){return e}},Vt=async(t="Jessica")=>{try{if(!t)throw new Error("user");const e=await Ht.get("apiGetUserNote.json"),s=e.data.filter((e=>e.userId===t));let r=localStorage.getItem("cherri-append-usernote");return r=r?JSON.parse(r).filter((e=>e.userId===t)):[],[...s,...r]}catch(e){return e}},Et=async t=>{t.id=(0,Tt.Z)();let e=localStorage.getItem("cherri-append-chatrecord");e=e?JSON.parse(e):[],e.push(t),localStorage.setItem("cherri-append-chatrecord",JSON.stringify(e))},Dt=async t=>{t.id=(0,Tt.Z)();let e=localStorage.getItem("cherri-append-usernote");e=e?JSON.parse(e):[],e.push(t),localStorage.setItem("cherri-append-usernote",JSON.stringify(e))},Bt=async t=>{let e=localStorage.getItem("cherri-append-usernote");e=JSON.parse(e),e=e.filter((e=>e.id!==t)),localStorage.setItem("cherri-append-usernote",JSON.stringify(e))};var At={apiGetUserList:jt,apiGetUserById:Ut,apiGetChatRecord:Rt,apiGetUserNote:Vt,apiAddChatRecord:Et,apiAddUserNote:Dt,apiDeleteUserNote:Bt};r.Z.prototype.$http=At,r.Z.prototype.$eventBus=new r.Z,r.Z.config.productionTip=!1,new r.Z({router:vt,store:Ct,i18n:Zt,vuetify:kt,render:t=>t(p)}).$mount("#app")},5786:function(t,e,s){t.exports=s.p+"img/img_default.f910cc3e.png"}},e={};function s(r){var a=e[r];if(void 0!==a)return a.exports;var n=e[r]={exports:{}};return t[r](n,n.exports,s),n.exports}s.m=t,function(){var t=[];s.O=function(e,r,a,n){if(!r){var i=1/0;for(h=0;h<t.length;h++){r=t[h][0],a=t[h][1],n=t[h][2];for(var o=!0,c=0;c<r.length;c++)(!1&n||i>=n)&&Object.keys(s.O).every((function(t){return s.O[t](r[c])}))?r.splice(c--,1):(o=!1,n<i&&(i=n));if(o){t.splice(h--,1);var l=a();void 0!==l&&(e=l)}}return e}n=n||0;for(var h=t.length;h>0&&t[h-1][2]>n;h--)t[h]=t[h-1];t[h]=[r,a,n]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){s.p="/vincent-cherrichat/"}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,r){var a,n,i=r[0],o=r[1],c=r[2],l=0;if(i.some((function(e){return 0!==t[e]}))){for(a in o)s.o(o,a)&&(s.m[a]=o[a]);if(c)var h=c(s)}for(e&&e(r);l<i.length;l++)n=i[l],s.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return s.O(h)},r=self["webpackChunkvincent_cherrichat"]=self["webpackChunkvincent_cherrichat"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=s.O(void 0,[998],(function(){return s(3327)}));r=s.O(r)})();
//# sourceMappingURL=app.77c979ff.js.map